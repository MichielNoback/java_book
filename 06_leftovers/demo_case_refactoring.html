

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>44. Demo case refactoring &#8212; The Java Track</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '06_leftovers/demo_case_refactoring';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="45. REST and MVC with Spring" href="../07_spring/REST_and_MVC_with_spring.html" />
    <link rel="prev" title="43. UML" href="UML.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/java_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/java_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">General info</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../keyboard_shortcuts.html">Keyboard shortcuts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1 - Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01_getting_started/intellij.html">1. A first IntelliJ project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_getting_started/essentials.html">2. The essence of Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_getting_started/basic_program_design.html">3. Basic program structure and flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_getting_started/objects_and_classes.html">4. Objects and classes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2 - Syntax</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../02_syntax/data_types.html">5. Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_syntax/arrays.html">6. Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_syntax/operators.html">7. Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_syntax/flow_control.html">8. Flow control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_syntax/methods.html">9. Methods and Constructors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_syntax/packages_imports.html">10. Packages and Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_syntax/naming_commenting.html">11. Naming and commenting stuff</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3 - Core APIs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../03_apis/interfaces.html">12. Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_apis/collections.html">13. The Collections API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_apis/class_object_methods.html">14. Methods of class Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_apis/records.html">15. Records</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_apis/sorting.html">16. Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_apis/exceptions.html">17. Exception handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_apis/io.html">18. File IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_apis/regex.html">19. Regular Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_apis/functional_programming.html">20. Functional programming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 4 - OOP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../04_oop/encapsulation.html">21. Encapsulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_oop/access_modifiers.html">22. Access modifiers &amp; Other keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_oop/inheritance.html">23. Inheritance and UML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_oop/enums.html">24. Enums: constants on steroids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_oop/encapsulation_revisited.html">25. Encapsulation revisited</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_oop/design_rules.html">26. Design rules summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_oop/inner_classes.html">27. Inner classes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 5 - Web Apps</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../05_web/refresher.html">28. A refresher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/toolbox.html">29. The toolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/first_project.html">30. A first project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/mvc.html">31. Implementing MVC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/thymeleaf_expressions.html">32. Thymeleaf expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/thymeleaf_flow_control.html">33. Thymeleaf flow control and fragments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/sessions.html">34. Sessions &amp; Scopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/servlet_details.html">35. Servlet details and lifecycle hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/databases.html">36. Database interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/ajax.html">37. A simple web service using Ajax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/filters_upload.html">38. Web filters and File uploads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/webbased_exercises1.html">39. Exercises intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_web/html_cheatsheet.html">40. HTML5 tags</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 6 - Leftovers</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="JUnit_basics.html">41. JUnit 5 basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="JUnit_advanced.html">42. JUnit 5 advanced features</a></li>
<li class="toctree-l1"><a class="reference internal" href="UML.html">43. UML</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">44. Demo case refactoring</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 7 - Spring (Boot)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../07_spring/REST_and_MVC_with_spring.html">45. REST and MVC with Spring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_spring/Dependency_injection.html">46. Dependency Injection in Spring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_spring/spring_annotations.html">47. Core (Spring) annotations</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/06_leftovers/demo_case_refactoring.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Demo case refactoring</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">44.1. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note-on-junit-tests">44.1.1. Note on JUnit tests</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-to-know-what-is-there">44.2. Get to know what is there</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#refactor">44.3. Refactor</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rename-variables-and-methods-to-adhere-to-java-standards">44.3.1. Rename variables and methods to adhere to Java standards.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-string-literal-to-constants">44.3.2. Extract string literal to constants</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-functionality-from-constructor-code">44.3.3. Extract functionality from constructor code.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rename-methods-and-variables-to-their-real-purpose">44.3.4. Rename methods and variables to their real purpose.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-single-responsibility-principle">44.3.5. The Single Responsibility Principle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-basic-oop-principles">44.3.6. Use basic OOP principles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-unneccesary-comments">44.3.7. Remove unneccesary comments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-result">44.3.8. The result</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#take-over">44.4. Take over</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="demo-case-refactoring">
<h1><span class="section-number">44. </span>Demo case refactoring<a class="headerlink" href="#demo-case-refactoring" title="Permalink to this headline">#</a></h1>
<div class="section" id="introduction">
<h2><span class="section-number">44.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>This will be quite a long post. One I hope you will finish! If you want to follow along in the code base,
you should clone the repo. It is available at <a class="reference external" href="https://michiel_noback&#64;bitbucket.org/minoba/refactoringtrainingproject.git">bitbucket</a>.
Check out commit <code class="docutils literal notranslate"><span class="pre">eaf007f</span></code> to have a look at the original project. It was created by a student of mine, a third year bioinformatics student who will remain anonymous. As final assignment of the course Introduction to Java programming, he wrote a
tool that can be used to read, summarize and filter files of the <code class="docutils literal notranslate"><span class="pre">gff3</span></code> format (see<a class="reference external" href="https://www.ensembl.org/info/website/upload/gff3.html">https://www.ensembl.org/info/website/upload/gff3.html</a>).
This flat-file format is used to describe (annotate) elements (features), such as genes and introns, on DNA molecules,
also supporting hierarchical or tree-like relationships. Here is a small example, copied (and slimmed down) from a much
larger file describing some piece of Potato DNA:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PGSC0003DMB000000010</span>	<span class="n">BGI</span>	<span class="n">gene</span>	<span class="mi">1242814</span>	<span class="mi">1245448</span>	<span class="o">.</span>	<span class="o">.</span>	<span class="o">.</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DMG400000001</span><span class="p">;</span>
<span class="n">PGSC0003DMB000000010</span>	<span class="n">Cufflinks</span>	<span class="n">mRNA</span>	<span class="mi">1242814</span>	<span class="mi">1245444</span>	<span class="o">.</span>	<span class="o">+</span>	<span class="o">.</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DMT400000001</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">PGSC0003DMG400000001</span><span class="p">;</span><span class="n">Source_id</span><span class="o">=</span><span class="n">RNASEQ44</span><span class="mf">.3678.0</span><span class="p">;</span><span class="n">Mapping_depth</span><span class="o">=</span><span class="mf">48.922289</span><span class="p">;</span><span class="n">Class</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">PGSC0003DMB000000010</span>	<span class="n">Cufflinks</span>	<span class="n">mRNA</span>	<span class="mi">1242814</span>	<span class="mi">1245444</span>	<span class="o">.</span>	<span class="o">+</span>	<span class="o">.</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DMT400000002</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">PGSC0003DMG400000001</span><span class="p">;</span><span class="n">Source_id</span><span class="o">=</span><span class="n">RNASEQ44</span><span class="mf">.3678.1</span><span class="p">;</span><span class="n">Mapping_depth</span><span class="o">=</span><span class="mf">349.773769</span><span class="p">;</span><span class="n">Class</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">PGSC0003DMB000000010</span>	<span class="n">Cufflinks</span>	<span class="n">mRNA</span>	<span class="mi">1243971</span>	<span class="mi">1245448</span>	<span class="o">.</span>	<span class="o">+</span>	<span class="o">.</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DMT400000003</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">PGSC0003DMG400000001</span><span class="p">;</span><span class="n">Source_id</span><span class="o">=</span><span class="n">RNASEQ44</span><span class="mf">.3678.2</span><span class="p">;</span><span class="n">Mapping_depth</span><span class="o">=</span><span class="mf">52.447281</span><span class="p">;</span><span class="n">Class</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">PGSC0003DMB000000010</span>	<span class="n">Cufflinks</span>	<span class="n">exon</span>	<span class="mi">1242814</span>	<span class="mi">1243429</span>	<span class="o">.</span>	<span class="o">+</span>	<span class="o">.</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DME400000001</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">PGSC0003DMT400000001</span><span class="p">,</span><span class="n">PGSC0003DMT400000002</span><span class="p">;</span>
<span class="n">PGSC0003DMB000000010</span>	<span class="n">Cufflinks</span>	<span class="n">exon</span>	<span class="mi">1243532</span>	<span class="mi">1243736</span>	<span class="o">.</span>	<span class="o">+</span>	<span class="o">.</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DME400000002</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">PGSC0003DMT400000001</span><span class="p">,</span><span class="n">PGSC0003DMT400000002</span><span class="p">;</span>
<span class="n">PGSC0003DMB000000010</span>	<span class="n">Cufflinks</span>	<span class="n">intron</span>	<span class="mi">1243430</span>	<span class="mi">1243531</span>	<span class="o">.</span>	<span class="o">+</span>	<span class="o">.</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DMI400000001</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">PGSC0003DMT400000001</span><span class="p">,</span><span class="n">PGSC0003DMT400000002</span><span class="p">;</span>
<span class="n">PGSC0003DMB000000010</span>	<span class="n">Cufflinks</span>	<span class="n">intron</span>	<span class="mi">1244851</span>	<span class="mi">1244983</span>	<span class="o">.</span>	<span class="o">+</span>	<span class="o">.</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DMI400000005</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">PGSC0003DMT400000002</span><span class="p">;</span>
<span class="n">PGSC0003DMB000000010</span>	<span class="n">BestORF</span>	<span class="n">CDS</span>	<span class="mi">1243614</span>	<span class="mi">1243736</span>	<span class="o">.</span>	<span class="o">+</span>	<span class="mi">0</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DMC400000001</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">PGSC0003DMT400000001</span><span class="p">;</span>
<span class="n">PGSC0003DMB000000010</span>	<span class="n">BestORF</span>	<span class="n">CDS</span>	<span class="mi">1244206</span>	<span class="mi">1244487</span>	<span class="o">.</span>	<span class="o">+</span>	<span class="mi">0</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DMC400000001</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">PGSC0003DMT400000001</span><span class="p">;</span>
<span class="n">PGSC0003DMB000000155</span>	<span class="n">BGI</span>	<span class="n">gene</span>	<span class="mi">1093109</span>	<span class="mi">1102125</span>	<span class="o">.</span>	<span class="o">.</span>	<span class="o">.</span>	<span class="n">ID</span><span class="o">=</span><span class="n">PGSC0003DMG400000278</span><span class="p">;</span>
</pre></div>
</div>
<p>It is a tab-separated file with this -abbreviated- specification:</p>
<p>Fields must be tab-separated. Also, all but the final field in each feature line must contain a value; “empty” columns should be denoted with a ‘.’</p>
<ol class="arabic simple">
<li><p><strong>seqid</strong> - name/ID of the chromosome or segment</p></li>
<li><p><strong>source</strong> - name of the program that generated this feature</p></li>
<li><p><strong>type</strong> - type of feature.</p></li>
<li><p><strong>start</strong> - Start position of the feature, starting at 1.</p></li>
<li><p><strong>end</strong> - End position of the feature, starting at 1.</p></li>
<li><p><strong>score</strong> - A floating point value.</p></li>
<li><p><strong>strand</strong> - defined as + (forward) or - (reverse).</p></li>
<li><p><strong>phase</strong> - One of ‘0’, ‘1’ or ‘2’. ‘0’ indicates that the first base of the feature is the first base of a codon, ‘1’ that the second
base is the first base of a codon, and so on.</p></li>
<li><p><strong>attributes</strong> - A semicolon-separated list of tag=value pairs, providing additional information about each feature. Some of these tags
are predefined, e.g. ID, Name, Alias, Parent.</p></li>
</ol>
<p>I chose this particular project because (a) it is simple enough to be understood (b) complex enough to be a serious challenge (c) it had
so many inline comments that the unintelligible code could be understood and (d) the functionality was (as far as I tested) not perfect,
but OK. The student had implemented all the required use cases. But the code itself was written like a big old script, with many (naming)
convention violations, OO violations, Encapsulation and Abstraction not applied. You’ll see many examples as we plod along.</p>
<p>I do not plan to finish the whole project here; there should be some challenge for you left.</p>
<div class="section" id="note-on-junit-tests">
<h3><span class="section-number">44.1.1. </span>Note on JUnit tests<a class="headerlink" href="#note-on-junit-tests" title="Permalink to this headline">#</a></h3>
<p>When taking over a code base like this, without any (J)Unit tests, it is a very good idea to develop JUnit tests in concert with your refactoring efforts.
Take a look at the (too) few JUnit tests that I added to this project as well.</p>
</div>
</div>
<div class="section" id="get-to-know-what-is-there">
<h2><span class="section-number">44.2. </span>Get to know what is there<a class="headerlink" href="#get-to-know-what-is-there" title="Permalink to this headline">#</a></h2>
<p>First, of course, you need to run the tool in different modes and study the existing code base to what exactly is going on.</p>
<p>Running it in this mode <code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">data/gff3_sample.gff3</span> <span class="pre">-s</span></code> will give a summary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">file</span>	<span class="n">gff3_sample</span><span class="o">.</span><span class="n">gff3</span>
<span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">features</span>	<span class="mi">22</span>
<span class="n">molecules</span> <span class="k">with</span> <span class="n">features</span><span class="p">:</span>
<span class="n">human15</span><span class="mf">.1</span>
	<span class="n">number</span> <span class="n">of</span> <span class="n">features</span>	<span class="mi">22</span>
		<span class="n">CDS</span>				<span class="mi">10</span>
		<span class="n">gene</span>				<span class="mi">1</span>
		<span class="n">three_prime_UT</span>				<span class="mi">4</span>
		<span class="n">mRNA</span>				<span class="mi">4</span>
		<span class="n">five_prime_UTR</span>				<span class="mi">3</span>
</pre></div>
</div>
<p>That’s not really lined out but it’ll do for now.</p>
<p>Another use case, looking for features of a specific type <code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">data/gff3_sample.gff3</span> <span class="pre">-ft</span> <span class="pre">mRNA</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">human15</span><span class="mf">.1</span> <span class="o">.</span> <span class="n">mRNA</span>            <span class="mi">214360</span>  <span class="mi">215771</span> <span class="o">.</span> <span class="o">+</span>   <span class="o">.</span> <span class="n">Comments</span><span class="o">=</span><span class="n">fixed</span><span class="o">+</span><span class="n">one</span><span class="o">+</span><span class="n">splice</span><span class="o">+</span><span class="n">junction</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">HsG8283</span><span class="p">;</span><span class="n">Evidence</span><span class="o">=</span><span class="mi">7000000069743825</span><span class="p">;</span><span class="n">Transcript_type</span><span class="o">=</span><span class="n">Novel_Transcript</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">Novel</span><span class="o">+</span><span class="n">Transcript</span><span class="o">%</span><span class="mi">2</span><span class="n">C</span><span class="o">+</span><span class="n">variant</span><span class="o">+%</span><span class="mi">28</span><span class="n">partial</span><span class="o">%</span><span class="mi">29</span><span class="p">;</span><span class="n">ID</span><span class="o">=</span><span class="n">HsT20206</span>
<span class="n">human15</span><span class="mf">.1</span> <span class="o">.</span> <span class="n">mRNA</span>            <span class="mi">214590</span>  <span class="mi">215772</span> <span class="o">.</span> <span class="o">+</span>   <span class="o">.</span> <span class="n">Comments</span><span class="o">=</span><span class="n">fixed</span><span class="o">+</span><span class="n">one</span><span class="o">+</span><span class="n">splice</span><span class="o">+</span><span class="n">site</span><span class="o">%</span><span class="mi">0</span><span class="n">A</span><span class="p">;</span><span class="n">Parent</span><span class="o">=</span><span class="n">HsG8283</span><span class="p">;</span><span class="n">Evidence</span><span class="o">=</span><span class="mi">7000000069600840</span><span class="p">;</span><span class="n">Transcript_type</span><span class="o">=</span><span class="n">Novel_Transcript</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">Novel</span><span class="o">+</span><span class="n">Transcript</span><span class="o">%</span><span class="mi">2</span><span class="n">C</span><span class="o">+</span><span class="n">variant</span><span class="o">+%</span><span class="mi">28</span><span class="n">partial</span><span class="o">%</span><span class="mi">29</span><span class="p">;</span><span class="n">ID</span><span class="o">=</span><span class="n">HsT20207</span>
<span class="n">human15</span><span class="mf">.1</span> <span class="o">.</span> <span class="n">mRNA</span>            <span class="mi">214301</span>  <span class="mi">215769</span> <span class="o">.</span> <span class="o">+</span>   <span class="o">.</span> <span class="n">Parent</span><span class="o">=</span><span class="n">HsG8283</span><span class="p">;</span><span class="n">Evidence</span><span class="o">=</span><span class="mi">7000000069974357</span><span class="p">;</span><span class="n">Transcript_type</span><span class="o">=</span><span class="n">Candidates</span><span class="o">+</span><span class="k">for</span><span class="o">+</span><span class="n">Deletion</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">Novel</span><span class="o">+</span><span class="n">Transcript</span><span class="o">+%</span><span class="mi">28</span><span class="n">partial</span><span class="o">%</span><span class="mi">29</span><span class="p">;</span><span class="n">ID</span><span class="o">=</span><span class="n">HsT16028</span>
<span class="n">human15</span><span class="mf">.1</span> <span class="o">.</span> <span class="n">mRNA</span>            <span class="mi">215218</span>  <span class="mi">215772</span> <span class="o">.</span> <span class="o">+</span>   <span class="o">.</span> <span class="n">Parent</span><span class="o">=</span><span class="n">HsG8283</span><span class="p">;</span><span class="n">Evidence</span><span class="o">=</span><span class="mi">7000000069512231</span><span class="p">;</span><span class="n">Transcript_type</span><span class="o">=</span><span class="n">Novel_Transcript</span><span class="p">;</span><span class="n">Name</span><span class="o">=</span><span class="n">Novel</span><span class="o">+</span><span class="n">Transcript</span><span class="o">%</span><span class="mi">2</span><span class="n">C</span><span class="o">+</span><span class="n">variant</span><span class="p">;</span><span class="n">ID</span><span class="o">=</span><span class="n">HsT16029</span>
</pre></div>
</div>
<p>Some more use cases were carried out. There do not seem to major bugs.</p>
<p>This is the simple class and package layout of the project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gff_query</span><span class="o">/</span><span class="n">control</span>
            <span class="n">GffLine</span>
         <span class="o">/</span><span class="n">io</span>
            <span class="n">CLIParser</span>
            <span class="n">FileReader</span>
         <span class="o">/</span><span class="n">model</span>
            <span class="n">GffFile</span>
         <span class="n">GffQuery</span> <span class="p">(</span><span class="n">main</span><span class="p">)</span>
</pre></div>
</div>
<p>This puzzles me a bit. I would expect something like GffLine to be in the <code class="docutils literal notranslate"><span class="pre">model</span></code> and <code class="docutils literal notranslate"><span class="pre">CLIParser</span></code> somewhere not in the <code class="docutils literal notranslate"><span class="pre">io</span></code> package. We’ll get to that.</p>
<p>A first inspection of the classes is a bit of a scare. Here is class <code class="docutils literal notranslate"><span class="pre">FileReader</span></code>.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nn">nl.bioinf.gff_query.io</span><span class="p">;</span>
<span class="c1">//imports omitted</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">FileReader</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">readFile</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">raw_path</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fileArrayList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">        </span><span class="n">Path</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Paths</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">raw_path</span><span class="p">);</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Files</span><span class="p">.</span><span class="na">newBufferedReader</span><span class="p">(</span>
<span class="w">                </span><span class="n">path</span><span class="p">,</span>
<span class="w">                </span><span class="n">Charset</span><span class="p">.</span><span class="na">defaultCharset</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">lineFromFile</span><span class="p">;</span>
<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">lineFromFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">fileArrayList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">lineFromFile</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error while reading file, \&quot;IOExceptio\&quot;, Did you give the correct location / does the &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s">&quot;file exist?&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">fileArrayList</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>OK…</p>
<p>This class does nothing more than processing the input file into a list of lines. Hello! Streaming processing? These files can get in the Gigabytes size.
Moreover, it catches an exception only to generate a <code class="docutils literal notranslate"><span class="pre">System.out.println</span></code> message. Some work to be done here for sure. Note the name <code class="docutils literal notranslate"><span class="pre">raw_path</span></code>. This is somebody coming from Python, it seems.</p>
<p>Next class, main: <code class="docutils literal notranslate"><span class="pre">GffQuery</span></code>. Take a minute to study its source before reading on. Note at least 5 points of improvement elegible for refactoring.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nn">nl.bioinf.gff_query</span><span class="p">;</span>
<span class="c1">//imports omitted</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">GffQuery</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// grab stuff from command line, try to parse.</span>
<span class="w">        </span><span class="n">CLIParser</span><span class="w"> </span><span class="n">my_cli_parser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CLIParser</span><span class="p">();</span>
<span class="w">        </span><span class="c1">// try to parse</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// before anything else, try for printing the help</span>
<span class="w">            </span><span class="kt">boolean</span><span class="w"> </span><span class="n">help_present</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">my_cli_parser</span><span class="p">.</span><span class="na">cliHelpParse</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">help_present</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">my_cli_parser</span><span class="p">.</span><span class="na">printHelp</span><span class="p">();}</span>
<span class="w">            </span><span class="k">else</span><span class="p">{</span>
<span class="w">                </span><span class="c1">// parse the command line arguments</span>
<span class="w">                </span><span class="n">my_cli_parser</span><span class="p">.</span><span class="na">cliParse</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="w">                </span><span class="c1">// if this worked, go on and grab all the arguments.</span>
<span class="w">                </span><span class="c1">// but first check if the inputs are correct.</span>
<span class="w">                </span><span class="kt">boolean</span><span class="w"> </span><span class="n">correct_inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">my_cli_parser</span><span class="p">.</span><span class="na">checkInputs</span><span class="p">();</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">correct_inputs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Something went wrong when checking inputs, some may be incorrect, please &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                            </span><span class="s">&quot;refer to the help page or check if your input file is correct.&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">parsed_arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">my_cli_parser</span><span class="p">.</span><span class="na">returnArguments</span><span class="p">();</span>
<span class="w">                    </span><span class="c1">// handle stuff based on the case.</span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">mycase</span><span class="p">;</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parsed_arguments</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;true&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// case 1, print summary.</span>
<span class="w">                        </span><span class="n">mycase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// case 2, actually apply filters and stuff.</span>
<span class="w">                        </span><span class="n">mycase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="c1">// before running the switch, read in file and make a GffFile object</span>
<span class="w">                    </span><span class="n">String</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsed_arguments</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
<span class="w">                    </span><span class="n">FileReader</span><span class="w"> </span><span class="n">filereader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">();</span>
<span class="w">                    </span><span class="c1">// read in the raw file and catch the resulting ArrayList</span>
<span class="w">                    </span><span class="n">ArrayList</span><span class="w"> </span><span class="n">fileArrayList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filereader</span><span class="p">.</span><span class="na">readFile</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fileArrayList</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">mycase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="c1">// parse it to a GffFile object.</span>
<span class="w">                    </span><span class="n">GffFile</span><span class="w"> </span><span class="n">myGffFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">GffFile</span><span class="p">(</span><span class="n">fileArrayList</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p">);</span>
<span class="w">                    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">mycase</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="w">                            </span><span class="c1">// do summary, not implemented as of yet.</span>
<span class="w">                            </span><span class="n">myGffFile</span><span class="p">.</span><span class="na">printSummary</span><span class="p">();</span>
<span class="w">                            </span><span class="k">break</span><span class="p">;</span>
<span class="w">                        </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">                            </span><span class="c1">// apply all filters.</span>
<span class="w">                            </span><span class="c1">// create filters array</span>
<span class="w">                            </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="p">;</span>
<span class="w">                            </span><span class="c1">// filters has all filters like so;</span>
<span class="w">                            </span><span class="c1">// fetch_type, fetch_region, filter, fetch_children, find_wildcard</span>
<span class="w">                            </span><span class="c1">// parsed_arguments had this;</span>
<span class="w">                            </span><span class="c1">// infile, summary, fetch_type, fetch_region, fetch_children, find_wildcard, filter</span>
<span class="w">                            </span><span class="n">filters</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsed_arguments</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>
<span class="w">                            </span><span class="n">filters</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsed_arguments</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span>
<span class="w">                            </span><span class="n">filters</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsed_arguments</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span><span class="p">;</span>
<span class="w">                            </span><span class="n">filters</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsed_arguments</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">;</span>
<span class="w">                            </span><span class="n">filters</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsed_arguments</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="p">;</span>
<span class="w">                            </span><span class="c1">// put in filters and print results</span>
<span class="w">                            </span><span class="n">myGffFile</span><span class="p">.</span><span class="na">applyFilters</span><span class="p">(</span><span class="n">filters</span><span class="p">);</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">myGffFile</span><span class="p">.</span><span class="na">toString</span><span class="p">().</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Oops, no lines found! Try to apply different filters. or double &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                        </span><span class="s">&quot;check them. It might also be possible that the file did not contain any&quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                        </span><span class="s">&quot; valid gff3 formatted lines.&quot;</span><span class="p">);</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">myGffFile</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>
<span class="w">                            </span><span class="k">break</span><span class="p">;</span>
<span class="w">                        </span><span class="k">case</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span>
<span class="w">                            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;empty or corrupt file.&quot;</span><span class="p">);</span>
<span class="w">                            </span><span class="k">break</span><span class="p">;</span>
<span class="w">                    </span><span class="p">}</span>

<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">catch</span><span class="p">(</span><span class="w"> </span><span class="n">ParseException</span><span class="w"> </span><span class="n">exp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// oops, something went wrong</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;command line input parsing failed. please refer to the manual using the \&quot;--help\&quot; &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                    </span><span class="s">&quot;argument&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>OK…again…</p>
<p>So here are a few aspects that need to be addressed:</p>
<ol class="arabic simple">
<li><p>Every line of code is in one big main</p></li>
<li><p>This is a Many Responsibilities class</p></li>
<li><p>Naming convention violations all over</p></li>
<li><p>Too complex flow control</p></li>
<li><p>Not OO at all</p></li>
<li><p>and more</p></li>
</ol>
<p>We’ll get to this class later.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">GffLine</span></code>, <code class="docutils literal notranslate"><span class="pre">GffFile</span></code> and <code class="docutils literal notranslate"><span class="pre">CLIParser</span></code> classes are similar in nature. I won’t show them all here. In this part, I would like to focus on class <code class="docutils literal notranslate"><span class="pre">CLIParser</span></code>. To get it right, I will need to refactor in other places as well, but this will be my starting point. Why start here? This is a class that should have an obvious Single Responsibility: taking care of command-line arguments. Have a look at the code yourself first and think where you would start.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nn">nl.bioinf.gff_query.io</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.cli.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.File</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CLIParser</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Options</span><span class="w"> </span><span class="n">options</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Options</span><span class="w"> </span><span class="n">help_options</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CommandLine</span><span class="w"> </span><span class="n">cmd</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CommandLine</span><span class="w"> </span><span class="n">help_cmd</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">DefaultParser</span><span class="w"> </span><span class="n">parser</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">HelpFormatter</span><span class="w"> </span><span class="n">formatter</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">CLIParser</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Create parser object</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">parser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultParser</span><span class="p">();</span>
<span class="w">        </span><span class="c1">// create Options object</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Options</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">help_options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Options</span><span class="p">();</span>
<span class="w">        </span><span class="c1">// add cli options</span>

<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">helpOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;h&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="s">&quot;help&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;Gives program help.&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">help_options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">helpOption</span><span class="p">);</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">helpOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">infileOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;i&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="s">&quot;infile&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;input gff3 file, e.g. \&quot;gff3_sample.gff3\&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">infileOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">summaryOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;s&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="s">&quot;summary&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;makes a summary of the gff3 file.&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">summaryOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">fetchtypeOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;ft&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="s">&quot;fetch_type&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;fetches type, e.g. \&quot;CDS\&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">fetchtypeOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">fetchregionOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;fr&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="s">&quot;fetch_region&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;fetches region in between start..end, e.g. \&quot;250000..260000\&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">fetchregionOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">fetchchildrenOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;fc&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="s">&quot;fetch_children&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;input which Parent group attributes to sort on, e.g. \&quot;PGSC0003DMT400039136\&quot;.&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">fetchchildrenOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">findwildcardOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;fw&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="s">&quot;find_wildcard&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;input which wildcard, e.g. \&quot;[dD]efesin\&quot; to match on. (gff3 name attribute)&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">findwildcardOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">filterOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;f&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="s">&quot;filter&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;miscellaneous filters, defined like&quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                        </span><span class="s">&quot; so: \&quot;source|score|orientation|maximum_length|minimum_length\&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">filterOption</span><span class="p">);</span>
<span class="w">        </span><span class="c1">// create help</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">formatter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HelpFormatter</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">cliParse</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">ParseException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">parser</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">checkInputs</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// check which inputs exist and check them (if neccesary)</span>
<span class="w">        </span><span class="c1">// check infile</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;infile&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">File</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;infile&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="na">exists</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">f</span><span class="p">.</span><span class="na">isDirectory</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// raise error that file does not exist.</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// check filter</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;filter&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// check if filter has correct formatting. If it does not, return false</span>
<span class="w">            </span><span class="c1">// &lt;SOURCE, SCORE, ORIENTATION MAXIMUM AND/OR MINIMUM LENGTH&gt;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;filter&quot;</span><span class="p">).</span><span class="na">matches</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;(.+\\|(\\d+|\\*|\\.)\\|(\\.|\\+|\\-|\\*)\\|(\\d+|\\*|\\.)\\|(\\d+|\\*|\\.))&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// check fetch region</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;fetch_region&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// check if fetch region has correct formatting.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;fetch_region&quot;</span><span class="p">).</span><span class="na">matches</span><span class="p">(</span><span class="s">&quot;\\d+\\.\\.\\d+&quot;</span><span class="p">)){</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;fetch_type&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// check if not a bool.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;fetch_type&quot;</span><span class="p">).</span><span class="na">matches</span><span class="p">(</span><span class="s">&quot;(true|false)&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;fetch_children&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// check if not a bool.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;fetch_children&quot;</span><span class="p">).</span><span class="na">matches</span><span class="p">(</span><span class="s">&quot;(true|false)&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;find_wildcard&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// check if not a bool.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;find_wildcard&quot;</span><span class="p">).</span><span class="na">matches</span><span class="p">(</span><span class="s">&quot;(true|false)&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">returnArguments</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">parsed_args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="o">[</span><span class="mi">7</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// build parsed_args array.</span>
<span class="w">        </span><span class="c1">// it is filled with options/null respectively like so;</span>
<span class="w">        </span><span class="c1">// infile, summary, fetch_type, fetch_region, fetch_children, find_wildcard, filter</span>
<span class="w">        </span><span class="c1">// Options without arguments, will be false if not present, and true when present.</span>
<span class="w">        </span><span class="c1">// Options with arguments, will also be false if not present, and their getOptionValue when present.</span>
<span class="w">        </span><span class="c1">// keep all values strings to be consistent.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;infile&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;infile&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;summary&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;fetch_type&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;fetch_type&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;fetch_region&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;fetch_region&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;fetch_children&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;fetch_children&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;find_wildcard&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;find_wildcard&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;filter&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;filter&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">parsed_args</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">cliHelpParse</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">ParseException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">help_cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultParser</span><span class="p">().</span><span class="na">parse</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">help_options</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">help_cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;help&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">help_cmd</span><span class="p">.</span><span class="na">getArgs</span><span class="p">().</span><span class="na">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">printHelp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// print the help or the version there. return true because help is printed</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">footer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;//omitted for brievity//&quot;</span><span class="p">;</span>

<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">formatter</span><span class="p">.</span><span class="na">printHelp</span><span class="p">(</span><span class="s">&quot;GffQuery&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Version: 1.1-SNAPSHOT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">,</span><span class="w"> </span><span class="n">footer</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since I really -really- hate it when people don’t adhere to naming conventions, I’ll start there.</p>
</div>
<div class="section" id="refactor">
<h2><span class="section-number">44.3. </span>Refactor<a class="headerlink" href="#refactor" title="Permalink to this headline">#</a></h2>
<div class="section" id="rename-variables-and-methods-to-adhere-to-java-standards">
<h3><span class="section-number">44.3.1. </span>Rename variables and methods to adhere to Java standards.<a class="headerlink" href="#rename-variables-and-methods-to-adhere-to-java-standards" title="Permalink to this headline">#</a></h3>
<p>So, <code class="docutils literal notranslate"><span class="pre">help_options</span></code> becomes <code class="docutils literal notranslate"><span class="pre">helpOptions</span></code>, and <code class="docutils literal notranslate"><span class="pre">help_cmd</span></code> becomes <code class="docutils literal notranslate"><span class="pre">helpCommandLine</span></code>. You may
note the absence of <code class="docutils literal notranslate"><span class="pre">help_cmd</span></code> in the final version. This is because there is no reason to maintain
it as an instance variable.</p>
<p>Remember by the way that methods should be verbs and variables should be nouns.</p>
</div>
<div class="section" id="extract-string-literal-to-constants">
<h3><span class="section-number">44.3.2. </span>Extract string literal to constants<a class="headerlink" href="#extract-string-literal-to-constants" title="Permalink to this headline">#</a></h3>
<p>As an example, you see the word “infile” typed several times:
<code class="docutils literal notranslate"><span class="pre">Option</span> <span class="pre">infileOption</span> <span class="pre">=</span> <span class="pre">Option.builder(&quot;i&quot;).longOpt(&quot;infile&quot;)</span></code>, <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">(this.cmd.hasOption(&quot;infile&quot;))</span></code>
(2 times). So this is the next step: get these out of the real code.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CLIParser</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//much code omitted in this snippet!</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">OPTION_INFILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;infile&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">OPTION_SUMMARY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;summary&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//...</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">CLIParser</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">infileOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;i&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="n">OPTION_INFILE</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;input gff3 file, e.g. \&quot;gff3_sample.gff3\&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">checkInputs</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// check which inputs exist and check them (if neccesary)</span>
<span class="w">        </span><span class="c1">// check infile</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_INFILE</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">File</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">cmd</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;infile&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="na">exists</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">f</span><span class="p">.</span><span class="na">isDirectory</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// raise error that file does not exist.</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Should the constants be public? Maybe, maybe not. Think about it.</p>
</div>
<div class="section" id="extract-functionality-from-constructor-code">
<h3><span class="section-number">44.3.3. </span>Extract functionality from constructor code.<a class="headerlink" href="#extract-functionality-from-constructor-code" title="Permalink to this headline">#</a></h3>
<p>Constructors should be short and readable, and only construct (maybe through calling other methods).
What I sometimes even see is code like this:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyApp</span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">MyApp</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">//more code</span>
<span class="p">}</span>
</pre></div>
</div>
<p>That means there is application logic in the constructor that is not even called explicitly!</p>
<p>So here is the new constructor of the CLIParser class:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">CLIParser</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">parser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultParser</span><span class="p">();</span>
<span class="w">        </span><span class="n">buildOptions</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>It calls the <code class="docutils literal notranslate"><span class="pre">buildOptions()</span></code> method to, well, build te options. This method creates both <code class="docutils literal notranslate"><span class="pre">this.options</span> <span class="pre">=</span> <span class="pre">new</span> <span class="pre">Options();</span></code>
and <code class="docutils literal notranslate"><span class="pre">this.helpOptions</span> <span class="pre">=</span> <span class="pre">new</span> <span class="pre">Options();</span></code>. That seems a bit funny but this is a workaround for the problem with <code class="docutils literal notranslate"><span class="pre">infileOption</span></code>
being required. This will throw an exception if it is absent. That conflicts with the case where only help is requested.</p>
</div>
<div class="section" id="rename-methods-and-variables-to-their-real-purpose">
<h3><span class="section-number">44.3.4. </span>Rename methods and variables to their real purpose.<a class="headerlink" href="#rename-methods-and-variables-to-their-real-purpose" title="Permalink to this headline">#</a></h3>
<p>The method <code class="docutils literal notranslate"><span class="pre">cliHelpParse()</span></code> does not parse help. No, its intent is to signal that help is requested:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">cliHelpParse</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">ParseException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">help_cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultParser</span><span class="p">().</span><span class="na">parse</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">help_options</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">help_cmd</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="s">&quot;help&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">help_cmd</span><span class="p">.</span><span class="na">getArgs</span><span class="p">().</span><span class="na">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>So I refactored it into the following version, with a more suitable name, the commandLine variable now being local, and the
<code class="docutils literal notranslate"><span class="pre">ParseException</span></code> not thrown anymore (this choice can be argued extensively).</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isHelpRequested</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">CommandLine</span><span class="w"> </span><span class="n">commandLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">parser</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">helpOptions</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_HELP</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ParseException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>A variant to this solution could be:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isHelpRequested</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">CommandLine</span><span class="w"> </span><span class="n">commandLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">parser</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_HELP</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ParseException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>Here, the helpOption instance variable has been made obsolete, and in the catch block is is simply assumed that if
anything goes wrong, help should be displayed. Which is the better?</p>
<p>Next, method <code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">void</span> <span class="pre">cliParse(String[]</span> <span class="pre">args)</span></code> was renamed to <code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">void</span> <span class="pre">parseCommandLineArguments(String[]</span> <span class="pre">args)</span></code>.</p>
</div>
<div class="section" id="the-single-responsibility-principle">
<h3><span class="section-number">44.3.5. </span>The Single Responsibility Principle<a class="headerlink" href="#the-single-responsibility-principle" title="Permalink to this headline">#</a></h3>
<p>The next aspect is the method <code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">boolean</span> <span class="pre">checkInputs()</span> <span class="pre">{}</span></code>. Is class CLIParse the place to do this? What if some other
means of options specification is implemeted, e.g. a GUI form? These options will need to be checked all the same. I think
<code class="docutils literal notranslate"><span class="pre">checkInputs</span></code> should not be in that class. But where else? Main? No, I think checking options, and keeping track of options,
should be the responsibility of a separate class. So that is where they’ll go. I created class <code class="docutils literal notranslate"><span class="pre">GffAnalysisOptions</span></code> and put
option checking in it:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">GffAnalysisOptions</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">inFile</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">summary</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">searchType</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">searchRegion</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">searchChildren</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">searchWildcard</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">searchFilter</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//getters and setters</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">checkCorrectnessOfInputs</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//checking code </span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="use-basic-oop-principles">
<h3><span class="section-number">44.3.6. </span>Use basic OOP principles<a class="headerlink" href="#use-basic-oop-principles" title="Permalink to this headline">#</a></h3>
<p>So, finally, there is this method (abbreviated):</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">returnArguments</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">parsed_args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="o">[</span><span class="mi">7</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// build parsed_args array.</span>
<span class="w">        </span><span class="c1">// it is filled with options/null respectively like so;</span>
<span class="w">        </span><span class="c1">// infile, summary, fetch_type, fetch_region, fetch_children, find_wildcard, filter</span>
<span class="w">        </span><span class="c1">// Options without arguments, will be false if not present, and true when present.</span>
<span class="w">        </span><span class="c1">// Options with arguments, will also be false if not present, and their getOptionValue when present.</span>
<span class="w">        </span><span class="c1">// keep all values strings to be consistent.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_INFILE</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;infile&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_SUMMARY</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FETCH_TYPE</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;fetch_type&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FETCH_REGION</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;fetch_region&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FETCH_REGION</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;fetch_children&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FIND_WILDCARD</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;find_wildcard&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FILTER</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="s">&quot;filter&quot;</span><span class="p">);}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">parsed_args</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">;}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">parsed_args</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>Auch! This hurts. A String[] with “false” values stored in it. Moreover, the code is so obfuscated that it needs many lines of
comments. Why didn’t this student think of an Options class of some kind, like <code class="docutils literal notranslate"><span class="pre">GffAnalysisOptions</span></code> (shown above)?</p>
<p>So here I wrote a replacement method for it:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">GffAnalysisOptions</span><span class="w"> </span><span class="nf">getAnalysisOptions</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">GffAnalysisOptions</span><span class="w"> </span><span class="n">gffAnalysisOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">GffAnalysisOptions</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_INFILE</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setInFile</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_INFILE</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_SUMMARY</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSummary</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FETCH_TYPE</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSearchType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_FETCH_TYPE</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FETCH_REGION</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSearchRegion</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_FETCH_REGION</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FETCH_CHILDREN</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSearchChildren</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_FETCH_CHILDREN</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FIND_WILDCARD</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSearchWildcard</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_FIND_WILDCARD</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FILTER</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSearchFilterAsString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_FILTER</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">gffAnalysisOptions</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>Of course, these options need to be processed further - primarily the filter option - before they can be put to use.</p>
<p>To replace the (fortunately localized) usage of the <code class="docutils literal notranslate"><span class="pre">String[]</span></code> with an <code class="docutils literal notranslate"><span class="pre">GffAnalysisOptions</span></code> instance, I switched to
class <code class="docutils literal notranslate"><span class="pre">GffQuery</span></code> and eased it in:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//much more code</span>

<span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">parsedArguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cliParser</span><span class="p">.</span><span class="na">returnArguments</span><span class="p">();</span>
<span class="w">        </span><span class="n">GffAnalysisOptions</span><span class="w"> </span><span class="n">analysisOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cliParser</span><span class="p">.</span><span class="na">getAnalysisOptions</span><span class="p">();</span>
<span class="w">        </span><span class="c1">//TODO replace use of parsedArguments with analysisOptions</span>

<span class="w">        </span><span class="c1">//more code</span>

<span class="w">        </span><span class="c1">// handle stuff based on the case.</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">mycase</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parsedArguments</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;true&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// case 1, print summary.</span>
<span class="w">            </span><span class="n">mycase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// case 2, actually apply filters and stuff.</span>
<span class="w">            </span><span class="n">mycase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">//much more code, also like this:</span>
<span class="w">            </span><span class="c1">// infile, summary, fetch_type, fetch_region, fetch_children, find_wildcard, filter</span>
<span class="w">            </span><span class="n">filters</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsedArguments</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>
<span class="w">            </span><span class="n">filters</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsedArguments</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span>
<span class="w">            </span><span class="n">filters</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsedArguments</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span><span class="p">;</span>
<span class="w">            </span><span class="n">filters</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsedArguments</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">;</span>
<span class="w">            </span><span class="n">filters</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parsedArguments</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>It is extremely tempting to refactor the other ugly code as well, such as the <code class="docutils literal notranslate"><span class="pre">mycase</span> <span class="pre">=</span> <span class="pre">1</span></code> ot the <code class="docutils literal notranslate"><span class="pre">String[]</span> <span class="pre">filters</span></code>, but restraint is very important in this kind of operation.
So, only refactor out the use of <code class="docutils literal notranslate"><span class="pre">parsedArguments</span></code> now, and keep on writing and running your JUnit tests to verify no functionality gets broken:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">analysisOptions</span><span class="p">.</span><span class="na">isSummaryRequested</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="c1">//            if (parsedArguments[1].equals(&quot;true&quot;)) {</span>
<span class="w">                </span><span class="c1">// case 1, print summary.</span>
<span class="w">                </span><span class="n">mycase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// case 2, actually apply filters and stuff.</span>
<span class="w">                </span><span class="n">mycase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="c1">// before running the switch, read in file and make a GffFile object</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analysisOptions</span><span class="p">.</span><span class="na">getInFile</span><span class="p">();</span><span class="c1">//parsedArguments[0];</span>

<span class="w">            </span><span class="c1">//more code </span>

<span class="w">                    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">filters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="p">;</span>
<span class="w">                    </span><span class="c1">// filters has all filters like so;</span>
<span class="w">                    </span><span class="c1">// fetch_type, fetch_region, filter, fetch_children, find_wildcard</span>
<span class="w">                    </span><span class="c1">// parsedArguments had this;</span>
<span class="w">                    </span><span class="c1">// infile, summary, fetch_type, fetch_region, fetch_children, find_wildcard, filter</span>
<span class="w">                    </span><span class="n">filters</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analysisOptions</span><span class="p">.</span><span class="na">getSearchType</span><span class="p">();</span>
<span class="w">                    </span><span class="n">filters</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analysisOptions</span><span class="p">.</span><span class="na">getSearchRegion</span><span class="p">();</span>
<span class="w">                    </span><span class="n">filters</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analysisOptions</span><span class="p">.</span><span class="na">getSearchFilter</span><span class="p">();</span>
<span class="w">                    </span><span class="n">filters</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analysisOptions</span><span class="p">.</span><span class="na">getSearchChildren</span><span class="p">();</span>
<span class="w">                    </span><span class="n">filters</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analysisOptions</span><span class="p">.</span><span class="na">getSearchWildcard</span><span class="p">();</span>
<span class="c1">//                    filters[0] = parsedArguments[2];</span>
<span class="c1">//                    filters[1] = parsedArguments[3];</span>
<span class="c1">//                    filters[2] = parsedArguments[6];</span>
<span class="c1">//                    filters[3] = parsedArguments[4];</span>
<span class="c1">//                    filters[4] = parsedArguments[5];</span>
</pre></div>
</div>
<p>Now the <code class="docutils literal notranslate"><span class="pre">returnArguments()</span></code> method can be removed. Do NOT comment it out because it clutters your code that is finally becoming readable.
If you want it back (or have a look at it), simply go to a previous commit.</p>
</div>
<div class="section" id="remove-unneccesary-comments">
<h3><span class="section-number">44.3.7. </span>Remove unneccesary comments<a class="headerlink" href="#remove-unneccesary-comments" title="Permalink to this headline">#</a></h3>
<p>Good code reads like a book! If you need it for yourself, your code is probably not very good.
API methods should be very well documented of course, but inline comments or private methods comments should ideally not be necessary. Keep them to a minimum! They get outdated and are becoming damaging by themselves. A comment like <code class="docutils literal notranslate"><span class="pre">/*builds</span> <span class="pre">the</span> <span class="pre">options*/</span></code> is entirely unnecessary!</p>
</div>
<div class="section" id="the-result">
<h3><span class="section-number">44.3.8. </span>The result<a class="headerlink" href="#the-result" title="Permalink to this headline">#</a></h3>
<p>This is the <code class="docutils literal notranslate"><span class="pre">CLIParser</span></code> class after complete refactoring:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nn">nl.bioinf.gff_query.io</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.cli.*</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CLIParser</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">OPTION_HELP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;help&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">OPTION_INFILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;infile&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">OPTION_SUMMARY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;summary&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">OPTION_FETCH_TYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;fetch_type&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">OPTION_FETCH_REGION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;fetch_region&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">OPTION_FETCH_CHILDREN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;fetch_children&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">OPTION_FIND_WILDCARD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;find_wildcard&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">OPTION_FILTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;filter&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/*private -&gt; testing*/</span><span class="w"> </span><span class="n">Options</span><span class="w"> </span><span class="n">options</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/*private -&gt; testing*/</span><span class="w"> </span><span class="n">CommandLine</span><span class="w"> </span><span class="n">commandLine</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">DefaultParser</span><span class="w"> </span><span class="n">parser</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">HelpFormatter</span><span class="w"> </span><span class="n">formatter</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Options</span><span class="w"> </span><span class="n">helpOptions</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">CLIParser</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">parser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultParser</span><span class="p">();</span>
<span class="w">        </span><span class="n">buildOptions</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildOptions</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Options</span><span class="p">();</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">helpOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Options</span><span class="p">();</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">helpOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;h&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="n">OPTION_HELP</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;Gives usage instructions&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">helpOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">helpOptions</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">helpOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">infileOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;i&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="n">OPTION_INFILE</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;The input gff3 file, as absolute or relative path&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">infileOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">summaryOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;s&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="n">OPTION_SUMMARY</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;lists a summary of the gff3 file&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">summaryOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">fetchtypeOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;ft&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="n">OPTION_FETCH_TYPE</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;Lists all features of the requested type, e.g. \&quot;CDS\&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">fetchtypeOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">fetchregionOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;fr&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="n">OPTION_FETCH_REGION</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;Lists all the features that reside completely within the given region; specified as start..end, e.g. \&quot;250000..260000\&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">fetchregionOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">fetchchildrenOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;fc&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="n">OPTION_FETCH_CHILDREN</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;Lists all child features of the given feature ID, e.g. \&quot;PGSC0003DMT400039136\&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">fetchchildrenOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">findwildcardOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;fw&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="n">OPTION_FIND_WILDCARD</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;Lists all features for which the \&quot;name\&quot; attribute matches the given wildcard, specified as regex pattern, &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                        </span><span class="s">&quot;e.g. \&quot;[dD]efesin\&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">findwildcardOption</span><span class="p">);</span>
<span class="w">        </span><span class="n">Option</span><span class="w"> </span><span class="n">filterOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Option</span><span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="s">&quot;f&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">longOpt</span><span class="p">(</span><span class="n">OPTION_FILTER</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">required</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">hasArg</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">desc</span><span class="p">(</span><span class="s">&quot;Lists all features that pass all of the given filters specified in the format string defined as&quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                        </span><span class="s">&quot;: \&quot;source|score|orientation|maximum_length|minimum_length\&quot; where the filters should be relevant to the &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                        </span><span class="s">&quot;given attribute. Suppression of an individual filter is indicated using an asterisk (*).&quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                        </span><span class="s">&quot;ORIENTATION should be defined using a \&quot;+\&quot;, \&quot;-\&quot; or \&quot;.\&quot; character&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">addOption</span><span class="p">(</span><span class="n">filterOption</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">printHelp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">formatter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HelpFormatter</span><span class="p">();</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">footer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;\nPaths are platform independent.&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">formatter</span><span class="p">.</span><span class="na">printHelp</span><span class="p">(</span><span class="s">&quot;GffQuery&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Version: 1.1-SNAPSHOT&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">,</span><span class="w"> </span><span class="n">footer</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isHelpRequested</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">CommandLine</span><span class="w"> </span><span class="n">commandLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">parser</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_HELP</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ParseException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">parseCommandLineArguments</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">ParseException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">parser</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">options</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">GffAnalysisOptions</span><span class="w"> </span><span class="nf">getAnalysisOptions</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">GffAnalysisOptions</span><span class="w"> </span><span class="n">gffAnalysisOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">GffAnalysisOptions</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_INFILE</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setInFile</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_INFILE</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_SUMMARY</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSummary</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FETCH_TYPE</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSearchType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_FETCH_TYPE</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FETCH_REGION</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSearchRegion</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_FETCH_REGION</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FETCH_CHILDREN</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSearchChildren</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_FETCH_CHILDREN</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FIND_WILDCARD</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSearchWildcard</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_FIND_WILDCARD</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">hasOption</span><span class="p">(</span><span class="n">OPTION_FILTER</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gffAnalysisOptions</span><span class="p">.</span><span class="na">setSearchFilterAsString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">commandLine</span><span class="p">.</span><span class="na">getOptionValue</span><span class="p">(</span><span class="n">OPTION_FILTER</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">gffAnalysisOptions</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="take-over">
<h2><span class="section-number">44.4. </span>Take over<a class="headerlink" href="#take-over" title="Permalink to this headline">#</a></h2>
<p>I challenge you to now take class <code class="docutils literal notranslate"><span class="pre">GffQuery</span></code> and make it look good! Check out tag 0.2 of branch <code class="docutils literal notranslate"><span class="pre">master</span></code> (commit 19a08f4).</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./06_leftovers"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="UML.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">43. </span>UML</p>
      </div>
    </a>
    <a class="right-next"
       href="../07_spring/REST_and_MVC_with_spring.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">45. </span>REST and MVC with Spring</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">44.1. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note-on-junit-tests">44.1.1. Note on JUnit tests</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-to-know-what-is-there">44.2. Get to know what is there</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#refactor">44.3. Refactor</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rename-variables-and-methods-to-adhere-to-java-standards">44.3.1. Rename variables and methods to adhere to Java standards.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-string-literal-to-constants">44.3.2. Extract string literal to constants</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-functionality-from-constructor-code">44.3.3. Extract functionality from constructor code.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rename-methods-and-variables-to-their-real-purpose">44.3.4. Rename methods and variables to their real purpose.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-single-responsibility-principle">44.3.5. The Single Responsibility Principle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-basic-oop-principles">44.3.6. Use basic OOP principles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-unneccesary-comments">44.3.7. Remove unneccesary comments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-result">44.3.8. The result</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#take-over">44.4. Take over</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Michiel Noback
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>